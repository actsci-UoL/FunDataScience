<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="These are the course notes for the 2023 version of Fundamentals of Data Science (MA7419 / MA3419)">

<title>Fundamentals of Data Science - 2&nbsp; Tabular data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week3.html" rel="next">
<link href="./week1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tabular data</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fundamentals of Data Science</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Getting Set Up</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started with R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tabular data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Group and summarise</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with tidy data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Joining tables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Clean and ethical data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Some other data structures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SQL</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">APIs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Final reports</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="toc-section-number">2.1</span>  Overview</a></li>
  <li><a href="#reading" id="toc-reading" class="nav-link" data-scroll-target="#reading"><span class="toc-section-number">2.2</span>  Reading</a></li>
  <li><a href="#digging-deeper-into-the-structure-of-a-data-frame" id="toc-digging-deeper-into-the-structure-of-a-data-frame" class="nav-link" data-scroll-target="#digging-deeper-into-the-structure-of-a-data-frame"><span class="toc-section-number">2.3</span>  Digging deeper into the structure of a data frame</a></li>
  <li><a href="#reading-data-from-a-tabular-file" id="toc-reading-data-from-a-tabular-file" class="nav-link" data-scroll-target="#reading-data-from-a-tabular-file"><span class="toc-section-number">2.4</span>  Reading data from a tabular file</a></li>
  <li><a href="#documentation-and-help" id="toc-documentation-and-help" class="nav-link" data-scroll-target="#documentation-and-help"><span class="toc-section-number">2.5</span>  Documentation and help</a></li>
  <li><a href="#simple-plots-with-ggplot" id="toc-simple-plots-with-ggplot" class="nav-link" data-scroll-target="#simple-plots-with-ggplot"><span class="toc-section-number">2.6</span>  Simple plots with ggplot</a></li>
  <li><a href="#question-for-you" id="toc-question-for-you" class="nav-link" data-scroll-target="#question-for-you">Question for you</a></li>
  <li><a href="#simple-maps-with-ggplot" id="toc-simple-maps-with-ggplot" class="nav-link" data-scroll-target="#simple-maps-with-ggplot"><span class="toc-section-number">2.7</span>  Simple maps with ggplot</a></li>
  <li><a href="#week-2-task" id="toc-week-2-task" class="nav-link" data-scroll-target="#week-2-task"><span class="toc-section-number">2.8</span>  Week 2 Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tabular data</span></h1>
</div>

<div>
  <div class="description">
    These are the course notes for the 2023 version of Fundamentals of Data Science <br>(MA7419 / MA3419)
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="overview" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">2.1</span> Overview</h2>
<p>This week we’ll be learning about the data structures: vectors, data frames &amp; tibbles.</p>
<p>Then we’ll be using the <code>dplyr</code> package (part of <code>tidyverse</code>) to begin manipulating tabular data.</p>
<p>We’ll be using the <code>dplyr</code> verbs select, filter, mutate and arrange.</p>
<p>By the end of this week you’ll be able to:</p>
<ol type="1">
<li>Explore a tabular data set interactively in the console</li>
<li>Manipulate tabular data using the functions in <code>dplyr</code></li>
<li>Read an external CSV or Excel file into R</li>
<li>Find the documentation for a function or package</li>
<li>Produce a simple scatter or bar chart in <code>ggplot2</code></li>
<li>Draw a simple map with <code>ggplot</code> and add points</li>
<li>Output your work as a PDF file from RStudio</li>
</ol>
<p>Believe it or not this small set of skills will enable you to do some very interesting exploratory data analysis (EDA)</p>
</section>
<section id="reading" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="reading"><span class="header-section-number">2.2</span> Reading</h2>
<p>R for Data Science <span class="citation" data-cites="wickhamR4DS">(<a href="references.html#ref-wickhamR4DS" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span>: - Chapter 5 - <em>Data transformation</em></p>
<p>R Programming for Data Science <span class="citation" data-cites="pengRP4DS">(<a href="references.html#ref-pengRP4DS" role="doc-biblioref">Peng 2020</a>)</span>: - Chapter 5 - <em>Getting Data in and out of R</em> - Chapter 6 - <em>Using the readr package</em></p>
</section>
<section id="digging-deeper-into-the-structure-of-a-data-frame" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="digging-deeper-into-the-structure-of-a-data-frame"><span class="header-section-number">2.3</span> Digging deeper into the structure of a data frame</h2>
<p>We’re going to use the <code>starwars</code> dataset that is automatically loaded with the package <code>dplyr</code>. To get it you will have to make sure <code>dplyr</code> is loaded (It’s one of the core <code>tidyverse</code> packages).</p>
<p>The first step in most analyses is to explore the data interactively in the console. The most common functions to do this are:</p>
<p><code>View(df)</code></p>
<p><code>head(df)</code></p>
<p><code>summary(df)</code></p>
<p><code>glimpse(df)</code></p>
<p><code>str(df)</code></p>
<p>You can watch a <a href="https://leicester.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=59ce1633-c156-4beb-ad77-ac5100b1d932">walk-through</a> of the use of these functions on the starwars data.</p>
<p>Each all the elements of each column of a data frame must be of the same type. In <code>starwars</code> there are elements of type <code>numeric</code>, <code>character</code> and list.</p>
<p><a href="https://leicester.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=aa29c726-9a20-42cd-9bfa-ac5100c08749">Here</a> is a demonstration of how to extract individual columns from a data frame.</p>
</section>
<section id="reading-data-from-a-tabular-file" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="reading-data-from-a-tabular-file"><span class="header-section-number">2.4</span> Reading data from a tabular file</h2>
<p>The most common way we’ll be using to get data into R will be to load it from file - usually a CSV or Excel file.</p>
<p>To read a CSV file we will use the <code>read_csv</code> function which is part of the <code>readr</code> package loaded with <code>tidyverse</code> (There is a function <code>read.csv</code> which is part of base R, but <code>readr::read_csv</code> is better.)</p>
<p>There are lots of optional parameters that you can use to refine the performance of <code>read_csv</code>, but it often works fine with just the path to the file.</p>
<p>For example, if we have a file of the 100 most popular girl babies names in England and Wales, in a file called <code>GirlsNames.csv</code> we can import it with the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>girls <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"_Data"</span>, <span class="st">"GirlsNames.csv"</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(girls, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
    Rank Name     Count
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
 1     1 OLIVIA    3866
 2     2 AMELIA    3546
 3     3 ISLA      2830
 4     4 AVA       2805
 5     5 MIA       2368
 6     6 ISABELLA  2297
 7     7 GRACE     2242
 8     8 SOPHIA    2236
 9     9 LILY      2181
10    10 EMILY     2150</code></pre>
</div>
</div>
<p>(Data downloaded from the <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/livebirths/datasets/babynamesenglandandwalesbabynamesstatisticsgirls">ONS</a>)</p>
<p><strong>Questions for you:</strong> Is this the most up to date list? Can you find a similar list from another country?</p>
<p>Data in Excel files can be read in similarly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"_Data"</span>, <span class="st">"UK_cities.xlsx"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cities <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Latitude) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   City            County      Latitude Longitude
   &lt;chr&gt;           &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
 1 Truro           Cornwall        50.3    -5.05 
 2 Plymouth        UK              50.4    -4.14 
 3 Exeter          the UK          50.7    -3.53 
 4 Bournemouth     UK              50.7    -1.90 
 5 Eastbourne      East Sussex     50.8     0.290
 6 Portsmouth      Hampshire       50.8    -1.09 
 7 Worthing        West Sussex     50.8    -0.384
 8 Brighton &amp; Hove East Sussex     50.8    -0.153
 9 Chichester      West Sussex     50.8    -0.779
10 Hastings        East Sussex     50.9     0.573</code></pre>
</div>
</div>
</section>
<section id="documentation-and-help" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="documentation-and-help"><span class="header-section-number">2.5</span> Documentation and help</h2>
<p>You should get into the habit of looking at the documentation for each function the first time you use it.</p>
<p>The first place to look is by using the built-in help in RStudio. You can either go to the help window and use the search, or you can type “?<function name="">” in the console. For example “?read_csv”. (You’ll usually need to have the relevant package loaded to get help, but “??<package name="">” might produce something useful.). The help information can sometimes be a bit technical and overwhelming, but there are usually helpful examples at the end.</package></function></p>
<p>Have a look at the help page for <code>read_csv</code> now.</p>
<p>The official repository for packages is called CRAN. There you will find the package documentation which always has a PDF reference document with details of all the functions in the package. You’ll also often find one or more <em>vignettes</em> which are tutorial-style documents giving an introduction to the package and maybe more detail on particular aspects.</p>
<p>Try a web search for “CRAN dplyr” now and see what you can find.</p>
<p>Of course, there is a lot of other support available online. You can try the <a href="https://www.tidyverse.org/">tidyverse site</a> or <a href="https://stackoverflow.com/questions/tagged/r">stack overflow</a></p>
</section>
<section id="simple-plots-with-ggplot" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="simple-plots-with-ggplot"><span class="header-section-number">2.6</span> Simple plots with ggplot</h2>
<p>Now we know how to get data into R it won’t be long before you want to plot it.</p>
<p>There are a number of alternatives but we’ll be using <code>ggplot</code>. The syntax can take a bit of getting used to, so here are a couple of simple examples.</p>
<p>There are three different components to making a plot in <code>ggplot</code>.</p>
<ol type="1">
<li>a data frame containing the data you want to plot</li>
<li>the type of plot you want</li>
<li>the columns containing the data to be plotted</li>
</ol>
<p>Here’s the simplest possible example using the <code>starwars</code> data. (here’s a <a href="https://leicester.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=14b2ce13-befd-4b27-80fc-ac5100c3ddeb">walk-through</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  starwars <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mass <span class="sc">&lt;</span> <span class="dv">1000</span>) <span class="co"># this is explained in the walk-through</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> mass, <span class="at">color =</span> sex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week2_files/figure-html/w2_plot1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Part 1 is dealt with by passing the data frame as a parameter to <code>ggplot</code>.</p>
<p>Part 2 is dealt with by choosing an appropriate <code>geom_</code> function.</p>
<p>Part 3 is dealt with by the parameters to the <code>aes</code> function. Note that different geoms have different <code>aes</code> requirements. See the built in help for the particular geom.</p>
<p>Here’s another example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> sex), <span class="at">fill =</span> <span class="st">"skyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week2_files/figure-html/w2_plot2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For a quick and easy guide to producing many types of plots see the R Graphics Cookbook <span class="citation" data-cites="changRGC">(<a href="references.html#ref-changRGC" role="doc-biblioref">Chang 2020</a>)</span>.</p>
</section>
<section id="question-for-you" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="question-for-you">Question for you</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
How can you add a title to a chart and change the axis labels?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use <code>ggtitle()</code>, <code>xlab()</code> and <code>ylab()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> sex), <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Number of Starwars characters by sex"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week2_files/figure-html/w2_check_understanding1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="simple-maps-with-ggplot" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="simple-maps-with-ggplot"><span class="header-section-number">2.7</span> Simple maps with ggplot</h2>
<p>There’s no denying that manipulating and visualizing spatial data can be very complex and most of the techniques are far beyond the scope of this course. But it’s such a powerful visualization method that I thought it was important to give you a way to get started by plotting points on a simple map.</p>
<p>If you want to find out more about this topic I recommend Geocomputation with R <span class="citation" data-cites="lovelaceGR">(<a href="references.html#ref-lovelaceGR" role="doc-biblioref">Robin Lovelace 2020</a>)</span></p>
<p>There are many formats for storing spatial data. In this example we use two: shapefiles and the relatively new Simple Features,</p>
<p>Shapefiles are well established, and most publishers of geographical information will make it available in this format (possibly alongside others)</p>
<p>The simple features format allows us to work with geographical data in the familiar form of a data frame, and to plot maps using <code>ggplot</code>. We’ll need to install the <code>sf</code> package before we can get started.</p>
<p>We are going to use low resolution country boundary shapefiles from <a href="https://hub.arcgis.com/datasets/bff789530b964a76938de17824165ceb_0/data" target="&quot;_blamk">here</a>. (I’ve already downloaded files for the UK and Ireland and put them in Blackboard.)</p>
<p>The first bit of code reads in two files and converts them to <code>sf</code> objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Ireland <span class="ot">&lt;-</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_read</span>(<span class="fu">here</span>(<span class="st">"_Data"</span>, <span class="st">"Ireland_Boundaries-shp"</span>, <span class="st">"Country_Boundaries.shp"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>UK <span class="ot">&lt;-</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_read</span>(<span class="fu">here</span>(<span class="st">"_Data"</span>, <span class="st">"UK_Boundaries-shp"</span>, <span class="st">"Country_Boundaries.shp"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at what’s inside one of these <code>sf</code> objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Ireland)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 8
$ OBJECTID_1 &lt;int&gt; 104
$ OBJECTID   &lt;int&gt; 104
$ name       &lt;chr&gt; "Ireland"
$ Id         &lt;int&gt; 0
$ Shape_Leng &lt;dbl&gt; 71.55104
$ Shape_Le_1 &lt;dbl&gt; 71.55104
$ Shape_Area &lt;dbl&gt; 9.443232
$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((-9.46639 51...</code></pre>
</div>
</div>
<p>We can see there is only one row and 8 columns. The row contains attributes and geometry information about a single feature - crucially it contains geometry information which, in this case defines a set of polygons which make up the boundary of Ireland.</p>
<p>Since they came from the same source, the UK file contains the same columns, so we can stick them together to create a single object which we can then plot using the <code>sf_geom</code> provided by <code>ggplot2</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>UK_IRL <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(UK, Ireland)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> UK_IRL) <span class="co"># We can plot m now, and add to it later.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week2_files/figure-html/w2_map1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To demonstrate how we can add additional points to this data, we’ll add the cities we listed above to the map. We’ll also change the limits of the plot to zoom in on the South East of the country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> cities, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">52</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week2_files/figure-html/w2_map2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>At this scale we can see the low resolution of the boundary information.</p>
</section>
<section id="week-2-task" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="week-2-task"><span class="header-section-number">2.8</span> Week 2 Task</h2>
<p>The task for Week 2 can be found in the Week 2 folder on Blackboard. This week you should knit your file to PDF and upload the RMD and PDF files.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-changRGC" class="csl-entry" role="doc-biblioentry">
Chang, Winston. 2020. <em>R Graphics Cookbook</em>. O’Reilly Media. <a href="https://r-graphics.org/">https://r-graphics.org/</a>.
</div>
<div id="ref-pengRP4DS" class="csl-entry" role="doc-biblioentry">
Peng, Roger D. 2020. <em>R Programming for Data Science</em>. Morrisville: Lulu.com. <a href="https://bookdown.org/rdpeng/rprogdatascience/">https://bookdown.org/rdpeng/rprogdatascience/</a>.
</div>
<div id="ref-lovelaceGR" class="csl-entry" role="doc-biblioentry">
Robin Lovelace, Jannes Muenchow, Jakub Nowosad. 2020. <em>Geocomputation with r</em>. CRC Press. <a href="https://geocompr.robinlovelace.net/">https://geocompr.robinlovelace.net/</a>.
</div>
<div id="ref-wickhamR4DS" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. O’Reilly Media. <a href="http://r4ds.had.co.nz/">http://r4ds.had.co.nz/</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started with R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week3.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Group and summarise</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>